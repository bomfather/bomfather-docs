document.addEventListener("DOMContentLoaded",async()=>{try{const o=await(await fetch("/images/external-link.svg",{cache:"force-cache"})).text(),i=e=>{try{const t=new URL(e.href,window.location.origin);return t.origin!==window.location.origin&&["http:","https:"].includes(t.protocol)}catch{return!1}};document.querySelectorAll("a[href]").forEach(e=>{if(!i(e)||e.querySelector("img, svg")||e.querySelector(".external-link-icon"))return;e.setAttribute("target","_blank");const t=(e.getAttribute("rel")||"").split(/\s+/).filter(Boolean);["noopener","noreferrer"].forEach(l=>{t.includes(l)||t.push(l)}),e.setAttribute("rel",t.join(" ")),e.classList.add("external-link");let c=e.lastChild;for(;c&&c.nodeType===Node.TEXT_NODE;){const l=c.textContent.replace(/\s+$/,"");if(l.length===c.textContent.length)break;c.textContent=l;break}const u=document.createElement("span");u.className="external-link-icon",u.setAttribute("aria-hidden","true"),u.innerHTML=o,e.appendChild(u)})}catch(n){console.warn("External link icon setup failed:",n)}});document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("announcement-banner");n&&(n.classList.contains("show")&&document.body.classList.add("has-announcement"),new MutationObserver(()=>{n.classList.contains("show")?document.body.classList.add("has-announcement"):document.body.classList.remove("has-announcement")}).observe(n,{attributes:!0,attributeFilter:["class"]}))});(function(){function n(){try{const e=document.getElementById("latest-news-banner"),t=e?e.offsetHeight:0;document.documentElement.style.setProperty("--latest-news-banner-height",`${t}px`)}catch{}}function o(){try{const e=document.querySelector(".header-nav"),t=e?e.offsetHeight:0;document.documentElement.style.setProperty("--header-height",`${t}px`)}catch{}}function i(){n(),o()}if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",()=>{i();const e=document.getElementById("latest-news-banner");e&&"ResizeObserver"in window&&new ResizeObserver(n).observe(e);const t=document.querySelector(".header-nav");t&&"ResizeObserver"in window&&new ResizeObserver(o).observe(t),window.addEventListener("resize",i,{passive:!0})});else{i();const e=document.getElementById("latest-news-banner");e&&"ResizeObserver"in window&&new ResizeObserver(n).observe(e);const t=document.querySelector(".header-nav");t&&"ResizeObserver"in window&&new ResizeObserver(o).observe(t),window.addEventListener("resize",i,{passive:!0})}})();window.dataLayer=window.dataLayer||[];function L(){dataLayer.push(arguments)}L("js",new Date);L("config","G-DK3MD3RFN4");function y(){const n=document.getElementById("mobile-menu-button"),o=document.getElementById("mobile-menu"),i=document.getElementById("mobile-menu-close");n?.addEventListener("click",()=>{o?.classList.add("show"),document.body.style.overflow="hidden",r&&(r.style.transform="none",r.classList.add("menu-open"))}),i?.addEventListener("click",()=>{o?.classList.remove("show"),document.body.style.overflow="auto",r&&(r.style.transform="",r.classList.remove("menu-open"))}),o?.addEventListener("click",s=>{s.target===o&&(o.classList.remove("show"),document.body.style.overflow="auto",r&&(r.style.transform="",r.classList.remove("menu-open")))});const e=document.querySelectorAll(".dropdown-trigger");let t=null,d=null;function c(){t||(t=document.createElement("div"),t.className="dropdown-backdrop",document.body.appendChild(t),t.addEventListener("click",h))}function u(){c(),setTimeout(()=>{t.classList.add("show")},10)}function l(){t&&t.classList.remove("show")}function h(){document.querySelectorAll(".dropdown-menu").forEach(s=>{s.classList.remove("mobile-show")}),d=null,l()}e.forEach(s=>{s.addEventListener("click",a=>{if(window.innerWidth<1024){a.preventDefault(),a.stopPropagation();const m=s.parentElement?.querySelector(".dropdown-menu");if(!m)return;if(d===m){h();return}h(),u(),setTimeout(()=>{m.classList.add("mobile-show"),d=m},50)}})}),document.addEventListener("click",s=>{window.innerWidth<1024&&!s.target?.closest(".group")&&!s.target?.closest(".dropdown-backdrop")&&h()}),window.addEventListener("resize",()=>{window.innerWidth>=1024&&h()});let w=window.scrollY,f=!1,r=document.querySelector(".header-nav"),b=r?.offsetHeight||0;r&&"ResizeObserver"in window&&new ResizeObserver(()=>{b=r.offsetHeight||0}).observe(r);function v(){const s=window.scrollY,a=document.querySelector(".header-nav"),m=o?.classList.contains("show");if(!a||m){w=s,f=!1;return}const p=s-w,E=p>2&&s>24,k=p<-2,O=-b;E?(a.style.transform=`translateY(${O}px)`,a.classList.add("header-hidden")):k&&(a.style.transform="translateY(0)",a.classList.remove("header-hidden")),w=s,f=!1}window.addEventListener("scroll",()=>{f||(window.requestAnimationFrame(v),f=!0)},{passive:!0}),window.requestAnimationFrame(v)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",y):y();const g="bomfather_announcement",B="disabled_2025";document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("announcement-banner"),o=document.getElementById("close-banner"),i=document.querySelector(".header-nav");if(!n||!o)return;function e(){n.classList.contains("show")?document.documentElement.style.setProperty("--banner-height",`${n.offsetHeight}px`):document.documentElement.style.setProperty("--banner-height","0px")}localStorage.getItem(g),n.classList.add("hidden"),o.addEventListener("click",()=>{localStorage.setItem(g,B),n.classList.remove("show"),e(),i&&(i.style.top="0"),setTimeout(()=>{n.classList.add("hidden")},300)}),window.addEventListener("resize",e)});
