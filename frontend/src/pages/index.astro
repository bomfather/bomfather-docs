---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/sections/Hero.astro';
import PageSection from '../components/ui/PageSection.astro';
import Card from '../components/ui/Card.astro';
import { homepageContent } from '../content/homepage';

// Extract content sections for easy reference
const { 
  hero, 
  socialProof, 
  attackVectors,
  howItWorks, 
  developerExperience
} = homepageContent;
---

<BaseLayout 
  title="Stop AI attacks before they execute - Bomfather"
  description="Bomfather embeds zero-trust defense inside the Linux kernel to block exploits in real time. Powered by eBPF for kernel-level AI security."
  showAnnouncement={false}
>
  <!-- Hero Section -->
  <Hero 
    title={hero.title}
    subtitle={hero.subtitle}
    primaryCTA={hero.primaryCTA}
    secondaryCTA={hero.secondaryCTA}
    metrics={hero.metrics}
  />

  <!-- Attack Vectors Section -->
  <PageSection 
    id="attack-vectors"
    variant="dark"
    size="md"
    title={attackVectors.title}
    centerHeader={true}
    className="bg-gradient-dark attack-vectors-section"
  >
    <div class="attack-vectors-container animate-stagger">
      <!-- AI Section -->
      <div class="attack-vector-section">
        <div class="section-header">
          <h3 class="section-title">{attackVectors.ai.header}</h3>
          <p class="section-description">{attackVectors.ai.headerDescription}</p>
        </div>
        
        <div class="attack-vector-cards">
          <!-- Traditional AI Security Card -->
          <Card 
            variant="glass"
            padding="lg"
            className="attack-vector-card animate-slide-up hover-lift"
            style="--delay: 0.1s"
          >
            <h4 class="attack-card-title">{attackVectors.ai.traditional.title}</h4>
            <p class="attack-card-description">{attackVectors.ai.traditional.description}</p>
            <ul class="attack-problems-list">
              {attackVectors.ai.traditional.problems.map((problem, index) => (
                <li class="problem-item animate-fade-in" style={`--delay: ${0.2 + index * 0.1}s`}>✗ {problem}</li>
              ))}
            </ul>
          </Card>
          
          <!-- Bomfather AI Protection Card -->
          <Card 
            variant="glass"
            padding="lg"
            className="attack-vector-card animate-slide-up hover-lift"
            style="--delay: 0.3s"
          >
            <h4 class="attack-card-title">{attackVectors.ai.bomfather.title}</h4>
            <ul class="attack-benefits-list">
              {attackVectors.ai.bomfather.benefits.map((benefit, index) => (
                <li class="benefit-item animate-fade-in" style={`--delay: ${0.4 + index * 0.1}s`}>✓ {benefit}</li>
              ))}
            </ul>
            <p class="attack-card-tagline">{attackVectors.ai.bomfather.tagline}</p>
          </Card>
        </div>
      </div>

      <!-- Separator Line -->
      <div class="attack-vectors-separator"></div>
      
      <!-- Builds Section -->
      <div class="attack-vector-section">
        <div class="section-header">
          <h3 class="section-title">{attackVectors.builds.header}</h3>
          <p class="section-description">{attackVectors.builds.headerDescription}</p>
        </div>
        
        <div class="attack-vector-cards">
          <!-- Traditional Build Security Card -->
          <Card 
            variant="glass"
            padding="lg"
            className="attack-vector-card animate-slide-up hover-lift"
            style="--delay: 0.5s"
          >
            <h4 class="attack-card-title">{attackVectors.builds.traditional.title}</h4>
            <p class="attack-card-description">{attackVectors.builds.traditional.description}</p>
            <ul class="attack-problems-list">
              {attackVectors.builds.traditional.problems.map((problem, index) => (
                <li class="problem-item animate-fade-in" style={`--delay: ${0.6 + index * 0.1}s`}>✗ {problem}</li>
              ))}
            </ul>
          </Card>
          
          <!-- Bomfather Build Protection Card -->
          <Card 
            variant="glass"
            padding="lg"
            className="attack-vector-card animate-slide-up hover-lift"
            style="--delay: 0.7s"
          >
            <h4 class="attack-card-title">{attackVectors.builds.bomfather.title}</h4>
            <ul class="attack-benefits-list">
              {attackVectors.builds.bomfather.benefits.map((benefit, index) => (
                <li class="benefit-item animate-fade-in" style={`--delay: ${0.8 + index * 0.1}s`}>✓ {benefit}</li>
              ))}
            </ul>
            <p class="attack-card-tagline">{attackVectors.builds.bomfather.tagline}</p>
          </Card>
        </div>
      </div>
    </div>
  </PageSection>

  <!-- Demo Video Section -->
  <PageSection 
    id="demo-video"
    variant="dark"
    size="lg"
    title="See It In Action"
    subtitle="Watch Bomfather demo to understand how it provides kernel-level AI security protection"
    centerHeader={true}
    className="demo-video-section"
  >
    <div class="demo-video-container animate-on-scroll">
      <div class="video-wrapper">
        <iframe 
          class="demo-video"
          src="https://www.youtube.com/embed/ALfsCJAW8_U"
          title="Bomfather Demo Video"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen
        ></iframe>
      </div>
      <div class="demo-info animate-fade-in" style="--delay: 0.3s">
        <p class="demo-description">
          This demo showcases Bomfather's kernel-level protection in action, blocking AI attacks before they execute. 
          Experience how our eBPF-based security transforms AI system protection.
        </p>
      </div>
    </div>
  </PageSection>

  <!-- How It Works Section -->
  <PageSection 
    id="how-it-works"
    variant="dark"
    size="lg"
    title={howItWorks.title}
    subtitle={howItWorks.subtitle}
    centerHeader={true}
  >
    <div class="steps-container">
      {howItWorks.steps.map((step, index) => (
        <div class="step-item animate-on-scroll" style={`--delay: ${index * 0.3}s`}>
          <div class="step-number animate-scale">
            <span class="step-number-text">{step.step}</span>
            <div class="step-number-bg"></div>
          </div>
          <div class="step-content">
            <h3 class="step-title animate-slide-up">{step.title}</h3>
            <p class="step-description animate-fade-in" style="--delay: 0.1s">{step.description}</p>
            {step.code && (
              <pre class="code-block animate-typing" data-code={step.code}><code class={`language-${step.language}`} id={`code-${index}`}></code></pre>
            )}
          </div>
        </div>
      ))}
    </div>
  </PageSection>

  <!-- Developer Experience Section -->
  <PageSection 
    id="developer-experience"
    variant="dark"
    size="lg"
    title={developerExperience.title}
    subtitle={developerExperience.subtitle}
    centerHeader={true}
  >
    <div class="dx-sections">
      {developerExperience.sections.map((section, index) => (
        <div class="dx-section animate-on-scroll" style={`--delay: ${index * 0.3}s`}>
          <div class="dx-text">
            <h3 class="animate-slide-up">{section.title}</h3>
            <p class="animate-fade-in" style="--delay: 0.1s">{section.description}</p>
          </div>
          <div class="dx-code">
            <pre class="code-block animate-typing" data-code={section.code}><code class={`language-${section.language}`} id={`dx-code-${index}`}></code></pre>
          </div>
        </div>
      ))}
    </div>
  </PageSection>


</BaseLayout>

<style>
/* Dark Theme Base */
:root {
  --bg-primary: #0a0d15;
  --bg-secondary: #0a0d15;
  --bg-tertiary: #0a0d15;
  --text-primary: #ffffff;
  --text-secondary: #a1a1aa;
  --text-tertiary: #71717a;
  --accent-primary: #3b82f6;
  --accent-secondary: #60a5fa;
  --accent-gradient: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
  --border-color: rgba(255, 255, 255, 0.1);
  --glass-bg: rgba(255, 255, 255, 0.05);
  --shadow-glow: 0 0 40px rgba(59, 130, 246, 0.15);
}

/* Global dark theme */
* {
  box-sizing: border-box;
}

body {
  background: #0a0d15 !important;
  color: var(--text-primary);
}

/* Background gradients */
.bg-gradient-dark {
  background: #0a0d15;
  position: relative;
}

.bg-gradient-dark::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: #0a0d15;
  pointer-events: none;
}

/* Animation Keyframes */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideLeft {
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.8); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes glow {
  0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.1); }
  50% { box-shadow: 0 0 40px rgba(59, 130, 246, 0.3); }
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
  40% { transform: translateY(-5px); }
  60% { transform: translateY(-3px); }
}

@keyframes bounceX {
  0%, 100% { transform: translateX(0); }
  50% { transform: translateX(5px); }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

@keyframes typing {
  from { width: 0; }
  to { width: 100%; }
}

/* Animation Classes */
.animate-fade-in {
  opacity: 0;
  animation: fadeIn 0.6s ease-out forwards;
  animation-delay: var(--delay, 0s);
}

.animate-slide-up {
  opacity: 0;
  animation: slideUp 0.8s ease-out forwards;
  animation-delay: var(--delay, 0s);
}

.animate-scale {
  opacity: 0;
  animation: scaleIn 0.6s ease-out forwards;
  animation-delay: var(--delay, 0s);
}

.animate-stagger > * {
  opacity: 0;
  animation: fadeIn 0.6s ease-out forwards;
  animation-delay: calc(var(--delay, 0s) + var(--stagger-delay, 0s));
}

.animate-on-scroll {
  opacity: 0;
  transform: translateY(30px);
  transition: all 0.8s ease-out;
}

.animate-on-scroll.in-view {
  opacity: 1;
  transform: translateY(0);
}

.animate-pop {
  opacity: 0;
  transform: scale(0.8);
  animation: scaleIn 0.4s ease-out forwards;
  animation-delay: var(--delay, 0s);
}

/* Hover Animations */
.hover-lift {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.hover-lift:hover {
  transform: translateY(-8px);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

.hover-glow {
  transition: all 0.3s ease;
}

.hover-glow:hover {
  box-shadow: var(--shadow-glow);
  border-color: var(--accent-secondary);
}

.hover-bounce {
  transition: transform 0.2s ease;
}

.hover-bounce:hover {
  animation: bounce 0.6s ease;
}

.hover-glow-scale {
  transition: all 0.3s ease;
}

.hover-glow-scale:hover {
  transform: scale(1.05);
  box-shadow: var(--shadow-glow);
  border-color: var(--accent-secondary);
  background: rgba(59, 130, 246, 0.08);
}

/* Social Proof Styles */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 2rem;
  margin-bottom: 4rem;
  text-align: center;
}

.stat-item {
  padding: 2rem 1rem;
  background: var(--glass-bg);
  border: 1px solid var(--border-color);
  border-radius: 1rem;
  backdrop-filter: blur(10px);
}

.stat-value {
  font-size: 3rem;
  font-weight: 700;
  background: var(--accent-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 0.5rem;
}

.stat-label {
  font-size: 0.875rem;
  color: #e4e4e7;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.logos-section {
  margin-bottom: 4rem;
}

.logos-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 2rem;
}

.logo-placeholder {
  text-align: center;
  padding: 1.5rem;
  background: var(--glass-bg);
  border: 1px solid var(--border-color);
  border-radius: 0.75rem;
  color: #e4e4e7;
  font-weight: 500;
  transition: all 0.3s ease;
}

.logo-placeholder:hover {
  border-color: var(--accent-primary);
  color: #ffffff;
}

/* Problem Solution Styles */
.problem-solution-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 2rem;
}

/* Solution Grid - Centered for single card */
.solution-grid {
  display: flex;
  justify-content: center;
  gap: 2rem;
}

.solution-grid .card {
  max-width: 500px;
  width: 100%;
}

.solution-grid .card p,
.solution-grid .card .card-content {
  color: #ffffff !important;
}

/* Attack Vectors Section Spacing */
.attack-vectors-section {
  padding-top: 2rem !important;
}

/* Card title and text improvements */
.problem-solution-grid .card h3,
.features-grid .card h3,
.get-started-options .card h3,
.integrations-grid .card h3 {
  color: #ffffff !important;
}

.problem-solution-grid .card p,
.features-grid .card p,
.get-started-options .card p,
.integrations-grid .card p {
  color: #e4e4e7 !important;
}

/* Specific fixes for card titles */
.card-title {
  color: #ffffff !important;
}

.card-content {
  margin-bottom: 2rem !important;
}

/* Get Started card specific improvements */
.get-started-card .card-title,
.get-started-card h3 {
  color: #ffffff !important;
  font-weight: 600;
}

.get-started-card .card-content {
  margin-bottom: 2.5rem !important;
}

.get-started-card p {
  color: #d1d5db !important;
  margin-bottom: 0;
}

/* Comprehensive title/header color fixes for all cards */
.card h1, .card h2, .card h3, .card h4, .card h5, .card h6,
.card .title, .card .card-title, .card .heading,
.feature-card h1, .feature-card h2, .feature-card h3, .feature-card h4, .feature-card h5, .feature-card h6,
.get-started-card h1, .get-started-card h2, .get-started-card h3, .get-started-card h4, .get-started-card h5, .get-started-card h6,
.stat-item h1, .stat-item h2, .stat-item h3, .stat-item h4, .stat-item h5, .stat-item h6 {
  color: #ffffff !important;
}

/* Additional title elements that might be missed */
[class*="card"] h1, [class*="card"] h2, [class*="card"] h3, [class*="card"] h4, [class*="card"] h5, [class*="card"] h6,
[class*="card"] .title, [class*="card"] .card-title, [class*="card"] .heading {
  color: #ffffff !important;
}

/* Get Started */
.get-started-options {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 2rem;
}

/* Steps Styles */
.steps-container {
  display: flex;
  flex-direction: column;
  gap: 4rem;
  max-width: 900px;
  margin: 0 auto;
}

.step-item {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 3rem;
  align-items: start;
}

.step-number {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 4rem;
  height: 4rem;
  flex-shrink: 0;
}

.step-number-bg {
  position: absolute;
  width: 100%;
  height: 100%;
  background: var(--accent-gradient);
  border-radius: 50%;
  animation: glow 3s ease-in-out infinite;
}

.step-number-text {
  position: relative;
  z-index: 1;
  color: white;
  font-weight: 700;
  font-size: 1.5rem;
}

.step-title {
  font-size: 1.75rem;
  font-weight: 600;
  margin-bottom: 1rem;
  color: #ffffff;
}

.step-description {
  color: #d1d5db;
  margin-bottom: 1.5rem;
  line-height: 1.7;
  font-size: 1.125rem;
}

.code-block {
  background: rgba(0, 0, 0, 0.4);
  border: 1px solid var(--border-color);
  border-radius: 0.75rem;
  padding: 1.5rem;
  overflow: hidden;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
  position: relative;
}

.code-block::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--accent-gradient);
  border-radius: 0.75rem 0.75rem 0 0;
}

.code-block code {
  color: #e5e7eb;
  font-size: 0.875rem;
  line-height: 1.6;
  display: block;
  white-space: pre;
  height: 100%;
  overflow: hidden;
}

/* Features Grid */
.features-section-wrapper {
  position: relative;
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
  gap: 2rem;
  position: relative;
  z-index: 2;
}

.feature-card {
  border: 1px solid var(--border-color);
  transition: all 0.3s ease;
}

.benefits-list {
  margin-top: 1.5rem;
  padding-left: 0;
  list-style: none;
}

.benefits-list li {
  position: relative;
  padding-left: 2rem;
  margin-bottom: 0.75rem;
  color: #d1d5db;
  line-height: 1.5;
}

.benefits-list li::before {
  content: '✓';
  position: absolute;
  left: 0;
  color: var(--accent-primary);
  font-weight: bold;
  font-size: 1.1rem;
}

/* Developer Experience */
.dx-sections {
  display: flex;
  flex-direction: column;
  gap: 4rem;
  margin-bottom: 4rem;
}

.dx-section {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 4rem;
  align-items: center;
}

.dx-text h3 {
  font-size: 1.75rem;
  font-weight: 600;
  margin-bottom: 1rem;
  color: #ffffff;
}

.dx-text p {
  color: #d1d5db;
  line-height: 1.7;
  font-size: 1.125rem;
}



.cta-button {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.875rem 2rem;
  border-radius: 0.5rem;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.3s ease;
}

.cta-button--primary {
  background: var(--accent-gradient);
  color: white;
  box-shadow: 0 4px 14px rgba(59, 130, 246, 0.3);
}

.cta-button--primary:hover {
  box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
  transform: translateY(-2px);
}

.cta-button--secondary {
  background: transparent;
  color: var(--accent-primary);
  border: 1px solid var(--accent-primary);
}

.cta-button--secondary:hover {
  background: var(--glass-bg);
  border-color: var(--accent-secondary);
}

.arrow {
  transition: transform 0.3s ease;
}

.animate-bounce-x {
  animation: bounceX 2s ease-in-out infinite;
}

/* Counter Animation */
.animate-counter {
  display: inline-block;
}

/* Demo Video Section */
.demo-video-section {
  position: relative;
  padding: 4rem 0;
}

.demo-video-container {
  max-width: 900px;
  margin: 0 auto;
  text-align: center;
}

.video-wrapper {
  position: relative;
  width: 100%;
  height: 0;
  padding-bottom: 56.25%; /* 16:9 aspect ratio */
  margin-bottom: 2rem;
  border-radius: 1rem;
  overflow: hidden;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  border: 1px solid var(--border-color);
  background: var(--glass-bg);
  backdrop-filter: blur(10px);
}

.video-wrapper::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent 30%, rgba(59, 130, 246, 0.05) 50%, transparent 70%);
  pointer-events: none;
  z-index: 1;
}

.demo-video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 1rem;
  transition: all 0.3s ease;
}

.video-wrapper:hover {
  box-shadow: var(--shadow-glow);
  border-color: var(--accent-secondary);
  transform: translateY(-4px);
}

.demo-info {
  max-width: 600px;
  margin: 0 auto;
}

.demo-description {
  color: #d1d5db;
  font-size: 1.125rem;
  line-height: 1.7;
  margin-bottom: 1.5rem;
}

.demo-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.5rem;
  background: var(--glass-bg);
  border: 1px solid var(--border-color);
  border-radius: 2rem;
  backdrop-filter: blur(10px);
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--accent-secondary);
  transition: all 0.3s ease;
}

.demo-badge:hover {
  border-color: var(--accent-primary);
  box-shadow: 0 4px 14px rgba(59, 130, 246, 0.2);
}

.badge-icon {
  font-size: 1.125rem;
  animation: pulse 2s ease-in-out infinite;
}

.badge-text {
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Responsive Design */
@media (max-width: 768px) {
  .dx-section {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  
  .step-item {
    grid-template-columns: 1fr;
    gap: 1rem;
    text-align: center;
  }
  
  .features-grid,
  .get-started-options {
    grid-template-columns: 1fr;
  }
  
  /* Demo Video Mobile Styles */
  .demo-video-section {
    padding: 2rem 0;
  }
  
  .demo-video-container {
    margin: 0 1rem;
  }
  
  .video-wrapper {
    margin-bottom: 1.5rem;
    border-radius: 0.75rem;
  }
  
  .demo-description {
    font-size: 1rem;
    padding: 0 1rem;
  }
  
  .demo-badge {
    padding: 0.625rem 1.25rem;
    font-size: 0.8125rem;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  
  .animate-bounce-x {
    animation: none;
  }
}

/* Attack Vectors Section */
.attack-vectors-container {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.attack-vector-section {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.section-header {
  text-align: center;
  margin-bottom: 1rem;
}

.section-title {
  margin: 0 0 0.5rem 0;
  font-size: 2rem;
  font-weight: 600;
  color: #ffffff !important;
}

.section-description {
  margin: 0;
  color: #d1d5db;
  font-size: 1.125rem;
  font-weight: 500;
  line-height: 1.6;
  max-width: 800px;
  margin: 0 auto;
}

.attack-vectors-separator {
  height: 2px;
  background: linear-gradient(90deg, transparent 0%, #3b82f6 20%, #60a5fa 50%, #3b82f6 80%, transparent 100%);
  margin: 3rem 0;
  border-radius: 2px;
}

.attack-vector-cards {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
}

.attack-vector-card {
  flex: 1;
  min-height: 300px;
  display: flex;
  flex-direction: column;
}

.attack-card-title {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 1rem;
  color: #ffffff !important;
}

.attack-card-description {
  color: #d1d5db;
  line-height: 1.6;
  margin-bottom: 1.5rem;
}

.attack-problems-list,
.attack-benefits-list {
  list-style: none;
  padding: 0;
  margin: 0 0 1.5rem 0;
  flex: 1;
}

.problem-item,
.benefit-item {
  padding: 0.5rem 0;
  color: #d1d5db;
  line-height: 1.5;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.problem-item:last-child,
.benefit-item:last-child {
  border-bottom: none;
}

.problem-item {
  color: #fca5a5;
}

.benefit-item {
  color: #86efac;
}

.attack-card-tagline {
  font-style: italic;
  color: #a1a1aa;
  font-size: 0.875rem;
  line-height: 1.5;
  margin-top: auto;
  padding-top: 1rem;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

@media (max-width: 768px) {
  .attack-vectors-container {
    gap: 2rem;
  }
  
  .attack-vector-section {
    gap: 1rem;
  }
  
  .section-header {
    padding: 1rem;
  }
  
  .attack-vector-cards {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .attack-vector-card {
    min-height: auto;
  }
  
  .attack-vectors-separator {
    margin: 2rem 0;
  }
}
</style>

<script>
// Intersection Observer for scroll animations
const observerOptions = {
  threshold: 0.1,
  rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('in-view');
    }
  });
}, observerOptions);

// Observe all scroll-animated elements
document.addEventListener('DOMContentLoaded', () => {
  const scrollElements = document.querySelectorAll('.animate-on-scroll');
  scrollElements.forEach(el => observer.observe(el));
  
  // Initialize typing animations
  initTypingAnimations();
  
  // Initialize counter animations
  initCounterAnimations();
  
  // Add stagger delays for grid items
  const staggerContainers = document.querySelectorAll('.animate-stagger');
  
  staggerContainers.forEach(container => {
    const items = container.children;
    Array.from(items).forEach((item, index) => {
      item.style.setProperty('--stagger-delay', `${index * 0.1}s`);
    });
  });
});

// Typing animation for code blocks
function initTypingAnimations() {
  const codeBlocks = document.querySelectorAll('.animate-typing');
  
  codeBlocks.forEach((block, index) => {
    const code = block.dataset.code;
    const codeElement = block.querySelector('code');
    
    if (code && codeElement) {
      // Calculate fixed height based on number of lines
      const lines = code.split('\n');
      const lineCount = lines.length;
      const lineHeight = 1.6; // rem
      const fontSize = 0.875; // rem  
      const paddingTop = 1.5; // rem
      const paddingBottom = 1.5; // rem
      
      // Calculate height in pixels (16px = 1rem)
      const contentHeight = lineCount * lineHeight * fontSize * 16;
      const totalPadding = (paddingTop + paddingBottom) * 16;
      const fixedHeight = contentHeight + totalPadding;
      
      // Set fixed height immediately to prevent expansion
      block.style.height = `${fixedHeight}px`;
      block.style.maxHeight = `${fixedHeight}px`;
      block.style.minHeight = `${fixedHeight}px`;
      
      // Ensure code element also has constraints
      const codeContentHeight = lineCount * lineHeight * fontSize * 16;
      codeElement.style.height = `${codeContentHeight}px`;
      codeElement.style.maxHeight = `${codeContentHeight}px`;
      
      let i = 0;
      const speed = 20;
      
      function typeWriter() {
        if (i < code.length) {
          codeElement.textContent += code.charAt(i);
          i++;
          setTimeout(typeWriter, speed);
        }
      }
      
      // Start typing animation when in view
      const blockObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting && codeElement.textContent === '') {
            setTimeout(typeWriter, 200);
          }
        });
      }, observerOptions);
      
      blockObserver.observe(block);
    }
  });
}

// Counter animation for metrics
function initCounterAnimations() {
  const counters = document.querySelectorAll('.animate-counter');
  
  counters.forEach(counter => {
    const target = counter.dataset.target || counter.textContent;
    const value = parseFloat(target.replace(/[^\d.]/g, ''));
    const suffix = target.replace(/[\d.]/g, '');
    
    if (!isNaN(value)) {
      const counterObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            animateCounter(counter, 0, value, suffix, 2000);
            counterObserver.unobserve(counter);
          }
        });
      }, observerOptions);
      
      counterObserver.observe(counter);
    }
  });
}

function animateCounter(element, start, end, suffix, duration) {
  const startTime = performance.now();
  
  function updateCounter(currentTime) {
    const elapsed = currentTime - startTime;
    const progress = Math.min(elapsed / duration, 1);
    
    // Easing function for smooth animation
    const easeOut = 1 - Math.pow(1 - progress, 3);
    const current = start + (end - start) * easeOut;
    
    // Format the number
    let displayValue;
    if (end >= 1000) {
      displayValue = (current / 1000).toFixed(1) + 'K';
    } else if (end >= 1) {
      displayValue = Math.floor(current).toString();
    } else {
      displayValue = current.toFixed(2);
    }
    
    element.textContent = displayValue + suffix.replace(/[\d.K]/g, '');
    
    if (progress < 1) {
      requestAnimationFrame(updateCounter);
    } else {
      element.textContent = element.dataset.target;
    }
  }
  
  requestAnimationFrame(updateCounter);
}
</script> 